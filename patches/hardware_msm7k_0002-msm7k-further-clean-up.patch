From 936be5d0a8330805ab7478541e2c9e71ddf3a04f Mon Sep 17 00:00:00 2001
From: Erwin Pannecoucke <erwin.pannecoucke@gmail.com>
Date: Tue, 18 Sep 2012 08:19:21 +0200
Subject: [PATCH] msm7k: further clean-up

Change-Id: If93aeaf6946095ffdcc565b6ccbd620a544176e0
---
 Android.mk |   17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)

diff --git a/Android.mk b/Android.mk
index 1a1ef22..5fe3b59 100644
--- a/Android.mk
+++ b/Android.mk
@@ -16,7 +16,12 @@
 
 ifeq ($(BOARD_USES_QCOM_HARDWARE),true)
 
-common_msm_dirs := librpc dspcrashd
+ifeq ($(BOARD_BUILDS_OWN_LIBRPC),true)
+   common_msm_dirs := dspcrashd
+else
+   common_msm_dirs := librpc dspcrashd
+endif
+
 msm7k_dirs := $(common_msm_dirs) boot
 
 ifeq ($(TARGET_BOARD_PLATFORM),msm7x27)
@@ -25,12 +30,12 @@ else
   ifeq ($(filter msm8960 msm8660 msm7627a msm7x30,$(TARGET_BOARD_PLATFORM)),)
      include $(call all-named-subdir-makefiles,$(common_msm_dirs))
   else
-    ifeq ($(BOARD_NEEDS_SRC_LIBRPC),true)
-    else
-     include $(call all-named-subdir-makefiles,librpc)
-    endif
+     ifeq ($(BOARD_BUILDS_OWN_LIBRPC),true)
+        include $(call all-named-subdir-makefiles)
+     else
+        include $(call all-named-subdir-makefiles,librpc)
+     endif
   endif
 endif
 
 endif
-endif
-- 
1.7.9.5

